function getURLParameter(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function run_geo(e){$.ajax({type:"GET",url:e,dataType:"xml",success:function(e){$(e).find("ip").each(function(){var e=$(this).find("city").text(),i=$(this).find("region").text();if(e!=i)var t=e+", "+i;else t=e;$('<input type="hidden" />').attr({name:"location",class:"location",value:t}).appendTo("form")})}})}function validateEmail(e){return/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(e)}$.get("http://ipinfo.io",function(e){geo_url="http://ipgeobase.ru:7020/geo?ip="+e.ip,run_geo(geo_url)},"jsonp"),utm=[],$.each(["utm_source","utm_medium","utm_campaign","utm_term","source_type","source","position_type","position","added","creative","matchtype"],function(e,i){$('<input type="hidden" />').attr({name:i,class:i,value:function(){return null==getURLParameter(i)?"-":getURLParameter(i)}}).appendTo("form")}),$('<input type="hidden" />').attr({name:"url",value:document.location.href}).appendTo("form"),$('<input type="hidden" />').attr({name:"title",value:document.title}).appendTo("form"),$(document).ready(function(){$(".map").append('<iframe src="ajax/map.html"></iframe>'),$('input[name="name"]').blur(function(){$(this).val().length<2&&$(this).addClass(" error-input ")}),$('input[name="name"]').focus(function(){$(this).removeClass(" error-input ")}),$('input[name="phone"]').mask("+7 (999) 999-99-99"),$('input[name="phone"]').blur(function(){18!=$(this).val().length&&$(this).addClass("error-input")}),$('input[name="phone"]').focus(function(){$(this).removeClass("error-input")}),$('input[name="email"]').blur(function(){validateEmail($(this).val())||$(this).addClass("error-input")}),$('input[name="email"]').focus(function(){$(this).removeClass("error-input")}),$(".xotite,.foot").click(function(){$(".pop_z").show("#pop_form").arcticmodal()}),$(".checkico").click(function(){$(this).toggleClass("active")}),$(".pr").click(function(){$(this).parent().children().removeClass("active_b"),$(this).addClass("active_b"),$(this).closest("section").find(".slide").removeClass("active_p"),$(this).closest("section").find('.slide[data-id="'+$(this).attr("data-id")+'"]').addClass("active_p")}),$(".pr").first().trigger("click"),$(".quest").click(function(){$(this).hasClass("active_q")?$(this).removeClass("active_q"):($(this).parent().children().removeClass("active_q"),$(this).addClass("active_q"))}),$(".smallslide").children("a").click(function(e){e.preventDefault();var i=$(this).attr("href"),t=$(this).closest(".left");t.find(".fancy").removeClass("dom"),t.find('.fancy[href="'+i+'"]').addClass("dom")});$(".slider_1").bxSlider({infiniteLoop:!0,controls:!1,pager:!0,pagerCustom:"#slider_1_control",auto:!1,speed:500,minSlides:1,maxSlides:1,moveSlides:1}),$(".slider_2").bxSlider({infiniteLoop:!0,nextSelector:".sec14 .ar_right",prevSelector:".sec14 .ar_left",controls:!0,pager:!1,auto:!1,speed:500,minSlides:1,maxSlides:1,moveSlides:1}),$(".slider_3").bxSlider({infiniteLoop:!0,nextSelector:".sec15 .comanda .ar_right",prevSelector:".sec15 .comanda .ar_left",controls:!0,pager:!1,auto:!1,speed:500,minSlides:1,maxSlides:1,moveSlides:1,slideWidth:316});$(".fancy").fancybox({maxWidth:"90%",maxHeight:"90%",padding:0,helpers:{overlay:{locked:!1},title:null},afterShow:function(){$(".fancybox-wrap").swipe({swipe:function(e,i){"left"===i&&$.fancybox.prev(i),"right"===i&&$.fancybox.next(i)}})}}),$("form").submit(function(e){if(e.preventDefault(),$(this).find('input[type="text"]').trigger("blur"),!$(this).find('input[type="text"]').hasClass("error-input")&&$(this).find(".checkico").hasClass("active")){var i=$(this).attr("method"),t=$(this).attr("action"),n=$(this).serialize();$(this).find('input[name="event"]').val();$.ajax({type:i,url:t,data:n,success:function(){$.arcticmodal("close"),$("#okgo").arcticmodal()}})}else{var a="";!$(this).find('input[name="name"]').hasClass("error-input")||$(this).find('input[name="phone"]').hasClass("error-input")||$(this).find('input[name="email"]').hasClass("error-input")?!$(this).find('input[name="phone"]').hasClass("error-input")||$(this).find('input[name="name"]').hasClass("error-input")||$(this).find('input[name="email"]').hasClass("error-input")?$(this).find('input[name="phone"]').hasClass("error-input")&&$(this).find('input[name="name"]').hasClass("error-input")&&!$(this).find('input[name="email"]').hasClass("error-input")&&(a="Пожалуйста введите имя и телефон"):a="Пожалуйста введите телефон":a="Пожалуйста введите имя",$(this).find('input[name="name"]').hasClass("error-input")&&!$(this).find('input[name="phone"]').hasClass("error-input")&&$(this).find('input[name="email"]').hasClass("error-input")?a="Пожалуйста введите имя и email":$(this).find('input[name="phone"]').hasClass("error-input")&&!$(this).find('input[name="name"]').hasClass("error-input")&&$(this).find('input[name="email"]').hasClass("error-input")?a="Пожалуйста введите телефон и email":$(this).find('input[name="phone"]').hasClass("error-input")&&$(this).find('input[name="name"]').hasClass("error-input")&&$(this).find('input[name="email"]').hasClass("error-input")?a="Пожалуйста введите имя, email и телефон":$(this).find(".checkico").hasClass("active")||(a="Пожалуйста согласитесь "),$("#form-error-text").html(a),$("#form-error-pop").arcticmodal()}})});